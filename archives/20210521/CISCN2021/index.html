<!DOCTYPE html><html lang="zh-cmn-Hans"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1"><meta name="viewport" content="initial-scale=1,minimum-scale=1"><meta name="Description" content=""><meta name="keywords" content=""><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-control" content="no-siteapp"><meta name="google" content="notranslate"><meta name="google-site-verification" content="_UayXaRvQdoIdVfgHdAuvUPxs3GEFAhmYKFVCXLwtcM"><meta name="renderer" content="webkit"><meta name="screen-orientation" content="landscape"><meta name="x5-orientation" content="landscape"><meta name="layoutmode" content="standard"><meta name="nightmode" content="disable"><meta name="imagemode" content="force"><meta name="wap-font-scale" content="no"><meta http-equiv="cleartype" content="on"><meta name="msapplication-tap-highlight" content="no"><link rel="apple-touch-icon" sizes="180x180" href="https://cdn.jsdelivr.net/gh/gyj1109/Blog-Resources@latest/icons/main/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://cdn.jsdelivr.net/gh/gyj1109/Blog-Resources@latest/icons/main/favicon-32x32.png"><link rel="icon" type="image/png" sizes="194x194" href="https://cdn.jsdelivr.net/gh/gyj1109/Blog-Resources@latest/icons/main/favicon-194x194.png"><link rel="icon" type="image/png" sizes="192x192" href="https://cdn.jsdelivr.net/gh/gyj1109/Blog-Resources@latest/icons/main/android-chrome-192x192.png"><link rel="icon" type="image/png" sizes="16x16" href="https://cdn.jsdelivr.net/gh/gyj1109/Blog-Resources@latest/icons/main/favicon-16x16.png"><link rel="manifest" href="https://cdn.jsdelivr.net/gh/gyj1109/Blog-Resources@latest/icons/main/manifest.json"><link rel="mask-icon" href="https://cdn.jsdelivr.net/gh/gyj1109/Blog-Resources@latest/icons/main/safari-pinned-tab.svg" color="#009688"><meta name="apple-mobile-web-app-title" content="Gyj1109's Blog"><meta name="application-name" content="Gyj1109's Blog"><meta name="msapplication-TileColor" content="#009688"><meta name="msapplication-TileImage" content="https://cdn.jsdelivr.net/gh/gyj1109/Blog-Resources@latest/icons/main/mstile-144x144.png"><meta name="msapplication-config" content="https://cdn.jsdelivr.net/gh/gyj1109/Blog-Resources@latest/icons/main/browserconfig.xml"><meta name="theme-color" content="#009688"><title>CISCN 2021 逆向题 CISCN_gift WP - Gyj1109&#39;s Blog</title><link rel="canonical" href="https://gyj1109.top/archives/20210521/CISCN2021/"><link href="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/css/bootstrap.min.css" rel="stylesheet"><link href="https://cdn.jsdelivr.net/gh/gyj1109/Blog-Resources@latest/css/hux-blog.min.css" rel="stylesheet"><link href="https://cdn.jsdelivr.net/npm/@fontsource/roboto-mono@4.3.0/index.min.css" rel="stylesheet" media="none" onload='this.media="all"'><link href="https://cdn.jsdelivr.net/npm/@fontsource/lora@4.3.0/index.min.css" rel="stylesheet" media="none" onload='this.media="all"'><link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet" media="none" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/PrismJS/prism-themes/themes/prism-material-light.min.css" type="text/css" media="none" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/line-numbers/prism-line-numbers.min.css" type="text/css" media="none" onload='this.media="all"'><link href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.css" rel="stylesheet" media="none" onload='this.media="all"'><!--[if lte IE 10]><script>window.location.href='https://gyj1109.top/ie/';</script><![endif]--><meta name="generator" content="Hexo 5.4.0"><link rel="sitemap" type="application/xml" title="Sitemap" href="/sitemap.xml"></head><body ontouchstart=""><nav class="navbar navbar-default navbar-custom navbar-fixed-top"><div class="container-fluid"><div class="navbar-header page-scroll"><button type="button" class="navbar-toggle"><span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></button> <a class="navbar-brand" href="/">Gyj1109&#39;s Blog</a></div><div id="huxblog_navbar"><div class="navbar-collapse"><ul class="nav navbar-nav navbar-right"><li><a href="/" onclick="handleMagic()">Home</a></li><li><a href="/search/" onclick="handleMagic()">Search</a></li><li><a href="/tags/" onclick="handleMagic()">Tags</a></li></ul></div></div></div></nav><script>var $body=document.body,$toggle=document.querySelector(".navbar-toggle"),$navbar=document.querySelector("#huxblog_navbar"),$collapse=document.querySelector(".navbar-collapse"),navOpen=!1;function handleMagic(e){$navbar.className.indexOf("in")>0?($navbar.className=" ",setTimeout((function(){$navbar.className.indexOf("in")<0&&($collapse.style.height="0px")}),400),navOpen=!1):($collapse.style.height="auto",$navbar.className+=" in",navOpen=!0)}$toggle.addEventListener("click",handleMagic)</script><header class="intro-header"><div class="container"><div class="row"><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class="site-heading"><h1 id="title1">CISCN 2021 逆向题 CISCN_gift WP</h1><span id="title2" class="subheading">世界那么大 我想去看看</span></div></div></div></div></header><div id="pjax"><script>document.getElementById("title1").innerHTML="CISCN 2021 逆向题 CISCN_gift WP",document.getElementById("title2").innerHTML="世界那么大 我想去看看"</script><article><div class="container"><div class="row"><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1 post-container"><div id="main"><p>CISCN 比赛正好撞上期中考，就没去参加。事后在学长的建议下复盘了一下 CISCN_gift，感觉收获良多，记录 WP 如下。</p><p>IDA7.5 打开一看，没有任何符号表。在 Strings 面板中发现大量 <code>fmt</code> 开头的函数，猜测使用 Go 语言编写，故使用 IDA7.6 打开。发现能正确识别出符号表：</p><img src="https://cdn.jsdelivr.net/gh/gyj1109/Blog-Resources@latest/post-assets/2021-05-21-CISCN2021/1.png" alt="[符号表] "><p>显然，最后6个函数是分析的重点所在。</p><p>先从 <code>main_main</code> 开始。</p><p>首先映入眼帘的就是3个666函数：<code>main_CISCN6666666</code>、<code>main_CISCN66666666</code> 和 <code>main_CISCN666666666</code>。一次查看并分析，无参无返回值，直接在最后一个 <code>main_CISCN666666666</code> 后下断点，发现这三个函数只是在控制台输出欢迎语，略过。</p><p>继续看 <code>main_main</code>。下面有个 <code>while</code>，但其实就是一个 <code>for(int i = 0; i &lt; 32; i++)</code>。其中有一个 <code>off_568230</code> 追踪以后发现是延迟时间表 <em>（其实不是，只是循环次数，但当时的直觉就认为这是字母延迟输出的延迟）</em>。故整理格式后命名：</p><img src="https://cdn.jsdelivr.net/gh/gyj1109/Blog-Resources@latest/post-assets/2021-05-21-CISCN2021/2.png" alt="[timeList] "><p>紧接着下方出现 Go 函数 <code>runtime_makeslice</code>。查阅资料发现该函数构造一个 <code>slice</code> 对象。根据下文猜测未被正确识别的 <code>v11</code> 应该就是其返回值。</p><p>紧接着的又是一个被错误识别成 <code>while</code> 的 <code>for(int j = 1; j &lt;= 4; j++)</code>。里面啥也没干，就只调用了 <code>main_wtf</code>。但这个调用有些奇怪：<code>main_wtf(0LL, j, sliced_, aTime, aTime);</code>。前两个看着没啥问题，后三个就挺有意思了。联想到，刚才创建的 <code>slice</code> 对象 <code>sliced</code>，以及 <code>slice</code> 对象的结构：</p><pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">type</span> slice <span class="token keyword">struct</span> <span class="token punctuation">&#123;</span>
    array unsafe<span class="token punctuation">.</span>Pointer
    <span class="token builtin">len</span>   <span class="token builtin">int</span>
    <span class="token builtin">cap</span>   <span class="token builtin">int</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>推测后三个参数应该是一个结构体，故创建之。调用变为 <code>main_wtf(0LL, j, sliceObj);</code>。</p><p><code>main_wtf</code> 函数暂时先不跟进分析，先继续分析 <code>main_main</code>。<em>j循环</em>完成后，出现语句 <code>v6 = *(&amp;v17 + qword_5B20E8);</code>。结合交叉引用中 <code>qword_5B20E8</code> 被 <code>main_wtf</code> 更改和下文对其的大量引用，推测 <code>qword_5B20E8</code> 为 <code>main_wtf</code> 函数的等效返回值（可以看作是返回值）。同时从上方的栈分配可知其应该小于17。回看 <code>v17</code> 变量，发现其是一个 <code>__int64</code> 对象。但从下方语句来看，其应该为一数组。结合 <code>qword_5B20E8</code> 小于17的线索，将其类型更改为 <code>__int8 v17[17]</code>。同时推测其为一 <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/S%E7%9B%92">S−box</a>。</p><p>再往下的部分都是 Go 标准库的 fprintf 的部分，唯独 <code>8 * (v6 ^ 0x66)</code> 感觉有些蹊跷，考虑是将 S−box 的返回值与 <code>0x66</code> 异或后输出。</p><p><code>main_main</code> 的分析到此结束，接下来看 <code>main_wtf</code>。</p><p>首先发现递归调用。调用时有 <code>v3 + 1</code> 也就是参数 <code>a1 + 1</code>，故判断参数 <code>a1</code> 为递归深度。</p><p><code>if ( depth == sliced.len - 1 )</code> 的含义显而易见，而 <code>else</code> 分支的代码和 <code>main_main</code> 的几乎一致，发生递归调用，深度+1。<code>then</code> 分支中调用了最后一个函数 <code>main_goooo</code>。若返回值为真则对 <code>qword_5B20E8</code> 进行操作。由此判断 <code>qword_5B20E8</code> 应该是加密数值，改名为 <code>enc</code>。</p><p>最后来分析 <code>main_goooo</code> 函数。在里头发现了一个奇怪的语法：<code>*(&amp;v3 + v2)</code>，考虑 <code>v3</code> 为一数组。看着 <code>LOBYTE(result)</code> 挺难受的，把函数返回类型也改一下。改完以后程序的运行逻辑一目了然。</p><img src="https://cdn.jsdelivr.net/gh/gyj1109/Blog-Resources@latest/post-assets/2021-05-21-CISCN2021/3.png" alt="[main_goooo] "><p>至此，函数主体逻辑已经清晰。写 Python 脚本模拟：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">enc <span class="token operator">=</span> <span class="token number">0</span>
timeLists <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">0x0A</span><span class="token punctuation">,</span> <span class="token number">0x0B</span><span class="token punctuation">,</span> <span class="token number">0x0C</span><span class="token punctuation">,</span> <span class="token number">0x0D</span><span class="token punctuation">,</span> <span class="token number">0x0E</span><span class="token punctuation">,</span> <span class="token number">0x0F</span><span class="token punctuation">,</span> <span class="token number">0x10</span><span class="token punctuation">,</span> <span class="token number">0x11</span><span class="token punctuation">,</span> <span class="token number">0x12</span><span class="token punctuation">,</span> <span class="token number">0x14</span><span class="token punctuation">,</span>
    <span class="token number">0x19</span><span class="token punctuation">,</span> <span class="token number">0x1E</span><span class="token punctuation">,</span> <span class="token number">0x28</span><span class="token punctuation">,</span> <span class="token number">0x42</span><span class="token punctuation">,</span> <span class="token number">0x66</span><span class="token punctuation">,</span> <span class="token number">0x0A0</span><span class="token punctuation">,</span> <span class="token number">0x936</span><span class="token punctuation">,</span> <span class="token number">0x3D21</span><span class="token punctuation">,</span> <span class="token number">0x149A7</span><span class="token punctuation">,</span> <span class="token number">0x243AC</span><span class="token punctuation">,</span>
    <span class="token number">0x0CB5BE</span><span class="token punctuation">,</span> <span class="token number">0x47DC61</span><span class="token punctuation">,</span> <span class="token number">0x16C0F46</span><span class="token punctuation">,</span> <span class="token number">0x262C432</span><span class="token punctuation">,</span> <span class="token number">0x4ACE299</span><span class="token punctuation">,</span> <span class="token number">0x10FBC92A</span><span class="token punctuation">,</span>
    <span class="token number">0x329ECDFD</span><span class="token punctuation">,</span> <span class="token number">0x370D7470</span>
<span class="token punctuation">]</span>

<span class="token keyword">def</span> <span class="token function">main_goooo</span><span class="token punctuation">(</span>array<span class="token punctuation">)</span><span class="token punctuation">:</span>
    box <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">5</span>
    <span class="token keyword">for</span> tmp <span class="token keyword">in</span> array<span class="token punctuation">:</span>
        box<span class="token punctuation">[</span>tmp<span class="token punctuation">]</span> <span class="token operator">^</span><span class="token operator">=</span> <span class="token number">1</span>
    <span class="token keyword">return</span> box<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">and</span> box<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span>

<span class="token keyword">def</span> <span class="token function">main_wtf</span><span class="token punctuation">(</span>depth<span class="token punctuation">,</span> j<span class="token punctuation">,</span> array<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">global</span> enc
    array<span class="token punctuation">[</span>depth<span class="token punctuation">]</span> <span class="token operator">=</span> j
    <span class="token keyword">if</span> depth <span class="token operator">==</span> <span class="token builtin">len</span><span class="token punctuation">(</span>array<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>main_goooo<span class="token punctuation">(</span>array<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            enc <span class="token operator">=</span> enc <span class="token operator">-</span> <span class="token number">17</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>enc <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>enc <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">0xF0F0F0F0F0F0F0F1</span><span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">64</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>enc <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">63</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> jj <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            main_wtf<span class="token punctuation">(</span>depth <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> jj<span class="token punctuation">,</span> array<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">main_main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">global</span> enc
    <span class="token keyword">for</span> aTime <span class="token keyword">in</span> timeLists<span class="token punctuation">:</span>
        enc <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            main_wtf<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> j<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> aTime<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>enc_time<span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    main_main<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>但是运行后可以发现这个算法极慢且输出无规律。查阅学长们的 WP 发现可以尝试计算 <code>enc</code> 的运行次数，故修改代码如下：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">enc <span class="token operator">=</span> <span class="token number">0</span>
enc_time <span class="token operator">=</span> <span class="token number">0</span>
timeLists <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">0x0A</span><span class="token punctuation">,</span> <span class="token number">0x0B</span><span class="token punctuation">,</span> <span class="token number">0x0C</span><span class="token punctuation">,</span> <span class="token number">0x0D</span><span class="token punctuation">,</span> <span class="token number">0x0E</span><span class="token punctuation">,</span> <span class="token number">0x0F</span><span class="token punctuation">,</span> <span class="token number">0x10</span><span class="token punctuation">,</span> <span class="token number">0x11</span><span class="token punctuation">,</span> <span class="token number">0x12</span><span class="token punctuation">,</span> <span class="token number">0x14</span><span class="token punctuation">,</span>
    <span class="token number">0x19</span><span class="token punctuation">,</span> <span class="token number">0x1E</span><span class="token punctuation">,</span> <span class="token number">0x28</span><span class="token punctuation">,</span> <span class="token number">0x42</span><span class="token punctuation">,</span> <span class="token number">0x66</span><span class="token punctuation">,</span> <span class="token number">0x0A0</span><span class="token punctuation">,</span> <span class="token number">0x936</span><span class="token punctuation">,</span> <span class="token number">0x3D21</span><span class="token punctuation">,</span> <span class="token number">0x149A7</span><span class="token punctuation">,</span> <span class="token number">0x243AC</span><span class="token punctuation">,</span>
    <span class="token number">0x0CB5BE</span><span class="token punctuation">,</span> <span class="token number">0x47DC61</span><span class="token punctuation">,</span> <span class="token number">0x16C0F46</span><span class="token punctuation">,</span> <span class="token number">0x262C432</span><span class="token punctuation">,</span> <span class="token number">0x4ACE299</span><span class="token punctuation">,</span> <span class="token number">0x10FBC92A</span><span class="token punctuation">,</span>
    <span class="token number">0x329ECDFD</span><span class="token punctuation">,</span> <span class="token number">0x370D7470</span>
<span class="token punctuation">]</span>

<span class="token keyword">def</span> <span class="token function">main_goooo</span><span class="token punctuation">(</span>array<span class="token punctuation">)</span><span class="token punctuation">:</span>
    box <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">5</span>
    <span class="token keyword">for</span> tmp <span class="token keyword">in</span> array<span class="token punctuation">:</span>
        box<span class="token punctuation">[</span>tmp<span class="token punctuation">]</span> <span class="token operator">^</span><span class="token operator">=</span> <span class="token number">1</span>
    <span class="token keyword">return</span> box<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">and</span> box<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span>

<span class="token keyword">def</span> <span class="token function">main_wtf</span><span class="token punctuation">(</span>depth<span class="token punctuation">,</span> j<span class="token punctuation">,</span> array<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">global</span> enc<span class="token punctuation">,</span>enc_time
    array<span class="token punctuation">[</span>depth<span class="token punctuation">]</span> <span class="token operator">=</span> j
    <span class="token keyword">if</span> depth <span class="token operator">==</span> <span class="token builtin">len</span><span class="token punctuation">(</span>array<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>main_goooo<span class="token punctuation">(</span>array<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            enc_time <span class="token operator">+=</span> <span class="token number">1</span>
            enc <span class="token operator">=</span> enc <span class="token operator">-</span> <span class="token number">17</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>enc <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>
                <span class="token punctuation">(</span>enc <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">0xF0F0F0F0F0F0F0F1</span><span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">64</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">-</span>
                              <span class="token punctuation">(</span><span class="token punctuation">(</span>enc <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">63</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> jj <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            main_wtf<span class="token punctuation">(</span>depth <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> jj<span class="token punctuation">,</span> array<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">main_main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">global</span> enc<span class="token punctuation">,</span> enc_time
    <span class="token keyword">for</span> aTime <span class="token keyword">in</span> timeLists<span class="token punctuation">:</span>
        enc <span class="token operator">=</span> <span class="token number">0</span>
        enc_time <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            main_wtf<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> j<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> aTime<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>enc_time<span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    main_main<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>得数列 <code>2, 20, 1056, 65792, 262656</code>。查询后得到通项公式 <code>2 ** n + 4 ** n</code>。于是直接写出模拟：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">for</span> n <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    enc <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">**</span>n <span class="token operator">+</span> <span class="token number">4</span><span class="token operator">**</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
        enc <span class="token operator">=</span> enc <span class="token operator">-</span> <span class="token number">17</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>enc <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>
            <span class="token punctuation">(</span>enc <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">0xF0F0F0F0F0F0F0F1</span><span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">64</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">-</span>
                            <span class="token punctuation">(</span><span class="token punctuation">(</span>enc <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">63</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>enc <span class="token operator">%</span> <span class="token number">17</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">", "</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>得数列 <code>2, 6, 3, 4, 0, 2, -5, 5, 2, 6, 3, 4, 0, 2</code>。可以发现其 8 个一组循环，但是其中出现负数。考虑到 <code>main_main</code> 中的 <code>sbox</code> 长度为 17，故 <code>-5</code> 等价于 <code>12</code>，数列为 <code>2, 6, 3, 4, 0, 2, 12, 5</code>。</p><p>由下述代码求得 <code>sbox</code> 的值：</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"IDA.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    __int8 sbox<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token operator">*</span><span class="token punctuation">(</span>_QWORD <span class="token operator">*</span><span class="token punctuation">)</span>sbox <span class="token operator">=</span> <span class="token number">0x5F53055504525E54LL</span><span class="token punctuation">;</span>
    <span class="token operator">*</span><span class="token punctuation">(</span>_QWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>sbox<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0x3025156540750LL</span><span class="token punctuation">;</span>
    sbox<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">87</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">17</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d, "</span><span class="token punctuation">,</span> sbox<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>得 <code>sbox = [84, 94, 82, 4, 85, 5, 83, 95, 80, 7, 84, 86, 81, 2, 3, 0]</code>。</p><p>最终代码：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">timeLists <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">0x0A</span><span class="token punctuation">,</span> <span class="token number">0x0B</span><span class="token punctuation">,</span> <span class="token number">0x0C</span><span class="token punctuation">,</span> <span class="token number">0x0D</span><span class="token punctuation">,</span> <span class="token number">0x0E</span><span class="token punctuation">,</span> <span class="token number">0x0F</span><span class="token punctuation">,</span> <span class="token number">0x10</span><span class="token punctuation">,</span> <span class="token number">0x11</span><span class="token punctuation">,</span> <span class="token number">0x12</span><span class="token punctuation">,</span> <span class="token number">0x14</span><span class="token punctuation">,</span>
    <span class="token number">0x19</span><span class="token punctuation">,</span> <span class="token number">0x1E</span><span class="token punctuation">,</span> <span class="token number">0x28</span><span class="token punctuation">,</span> <span class="token number">0x42</span><span class="token punctuation">,</span> <span class="token number">0x66</span><span class="token punctuation">,</span> <span class="token number">0x0A0</span><span class="token punctuation">,</span> <span class="token number">0x936</span><span class="token punctuation">,</span> <span class="token number">0x3D21</span><span class="token punctuation">,</span> <span class="token number">0x149A7</span><span class="token punctuation">,</span> <span class="token number">0x243AC</span><span class="token punctuation">,</span>
    <span class="token number">0x0CB5BE</span><span class="token punctuation">,</span> <span class="token number">0x47DC61</span><span class="token punctuation">,</span> <span class="token number">0x16C0F46</span><span class="token punctuation">,</span> <span class="token number">0x262C432</span><span class="token punctuation">,</span> <span class="token number">0x4ACE299</span><span class="token punctuation">,</span> <span class="token number">0x10FBC92A</span><span class="token punctuation">,</span>
    <span class="token number">0x329ECDFD</span><span class="token punctuation">,</span> <span class="token number">0x370D7470</span>
<span class="token punctuation">]</span>
sbox <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">84</span><span class="token punctuation">,</span> <span class="token number">94</span><span class="token punctuation">,</span> <span class="token number">82</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">85</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">83</span><span class="token punctuation">,</span> <span class="token number">95</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">84</span><span class="token punctuation">,</span> <span class="token number">86</span><span class="token punctuation">,</span> <span class="token number">81</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span>
enc_cycle <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>sbox<span class="token punctuation">[</span>enc_cycle<span class="token punctuation">[</span><span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token number">0x66</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> timeLists<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>输出 <code>4b445b3247c45344c54c44734445452c</code></p><p>最终 flag：<code>CISCN&#123;4b445b3247c45344c54c44734445452c&#125;</code></p><p>附：</p><p><a target="_blank" rel="noopener" href="https://cdn.jsdelivr.net/gh/gyj1109/Blog-Resources@master/post-assets/2021-05-21-CISCN2021/CISCN_gift.zip">exe 及 i64 文件 (请使用 IDA7.6)</a></p><p>所有 Python 代码：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">enc <span class="token operator">=</span> <span class="token number">0</span>
enc_time <span class="token operator">=</span> <span class="token number">0</span>
timeLists <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">0x0A</span><span class="token punctuation">,</span> <span class="token number">0x0B</span><span class="token punctuation">,</span> <span class="token number">0x0C</span><span class="token punctuation">,</span> <span class="token number">0x0D</span><span class="token punctuation">,</span> <span class="token number">0x0E</span><span class="token punctuation">,</span> <span class="token number">0x0F</span><span class="token punctuation">,</span> <span class="token number">0x10</span><span class="token punctuation">,</span> <span class="token number">0x11</span><span class="token punctuation">,</span> <span class="token number">0x12</span><span class="token punctuation">,</span> <span class="token number">0x14</span><span class="token punctuation">,</span>
    <span class="token number">0x19</span><span class="token punctuation">,</span> <span class="token number">0x1E</span><span class="token punctuation">,</span> <span class="token number">0x28</span><span class="token punctuation">,</span> <span class="token number">0x42</span><span class="token punctuation">,</span> <span class="token number">0x66</span><span class="token punctuation">,</span> <span class="token number">0x0A0</span><span class="token punctuation">,</span> <span class="token number">0x936</span><span class="token punctuation">,</span> <span class="token number">0x3D21</span><span class="token punctuation">,</span> <span class="token number">0x149A7</span><span class="token punctuation">,</span> <span class="token number">0x243AC</span><span class="token punctuation">,</span>
    <span class="token number">0x0CB5BE</span><span class="token punctuation">,</span> <span class="token number">0x47DC61</span><span class="token punctuation">,</span> <span class="token number">0x16C0F46</span><span class="token punctuation">,</span> <span class="token number">0x262C432</span><span class="token punctuation">,</span> <span class="token number">0x4ACE299</span><span class="token punctuation">,</span> <span class="token number">0x10FBC92A</span><span class="token punctuation">,</span>
    <span class="token number">0x329ECDFD</span><span class="token punctuation">,</span> <span class="token number">0x370D7470</span>
<span class="token punctuation">]</span>


<span class="token keyword">def</span> <span class="token function">main_goooo</span><span class="token punctuation">(</span>array<span class="token punctuation">)</span><span class="token punctuation">:</span>
    box <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">5</span>
    <span class="token keyword">for</span> tmp <span class="token keyword">in</span> array<span class="token punctuation">:</span>
        box<span class="token punctuation">[</span>tmp<span class="token punctuation">]</span> <span class="token operator">^</span><span class="token operator">=</span> <span class="token number">1</span>
    <span class="token keyword">return</span> box<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">and</span> box<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span>


<span class="token keyword">def</span> <span class="token function">main_wtf</span><span class="token punctuation">(</span>depth<span class="token punctuation">,</span> j<span class="token punctuation">,</span> array<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">global</span> enc<span class="token punctuation">,</span> enc_time
    array<span class="token punctuation">[</span>depth<span class="token punctuation">]</span> <span class="token operator">=</span> j
    <span class="token keyword">if</span> depth <span class="token operator">==</span> <span class="token builtin">len</span><span class="token punctuation">(</span>array<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>main_goooo<span class="token punctuation">(</span>array<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            enc_time <span class="token operator">+=</span> <span class="token number">1</span>
            enc <span class="token operator">=</span> enc <span class="token operator">-</span> <span class="token number">17</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>enc <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>
                <span class="token punctuation">(</span>enc <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">0xF0F0F0F0F0F0F0F1</span><span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">64</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">-</span>
                              <span class="token punctuation">(</span><span class="token punctuation">(</span>enc <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">63</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> jj <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            main_wtf<span class="token punctuation">(</span>depth <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> jj<span class="token punctuation">,</span> array<span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">main_main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">global</span> enc<span class="token punctuation">,</span> enc_time
    <span class="token keyword">for</span> aTime <span class="token keyword">in</span> timeLists<span class="token punctuation">:</span>
        enc <span class="token operator">=</span> <span class="token number">0</span>
        enc_time <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            main_wtf<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> j<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> aTime<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>enc_time<span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">try_enc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> n <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        enc <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">**</span>n <span class="token operator">+</span> <span class="token number">4</span><span class="token operator">**</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
            enc <span class="token operator">=</span> enc <span class="token operator">-</span> <span class="token number">17</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>enc <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>
                <span class="token punctuation">(</span>enc <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">0xF0F0F0F0F0F0F0F1</span><span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">64</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">-</span>
                              <span class="token punctuation">(</span><span class="token punctuation">(</span>enc <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">63</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>enc<span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">", "</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">flag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    sbox <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">84</span><span class="token punctuation">,</span> <span class="token number">94</span><span class="token punctuation">,</span> <span class="token number">82</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">85</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">83</span><span class="token punctuation">,</span> <span class="token number">95</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">84</span><span class="token punctuation">,</span> <span class="token number">86</span><span class="token punctuation">,</span> <span class="token number">81</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span>
    enc_cycle <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>sbox<span class="token punctuation">[</span>enc_cycle<span class="token punctuation">[</span><span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token number">0x66</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> timeLists<span class="token punctuation">)</span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    <span class="token comment"># main_main()</span>
    <span class="token comment"># try_enc()</span>
    flag<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><hr><ul class="pager"><li class="previous"><a href="/archives/20210525/test/" title="Markdown Test">&larr; Previous Post</a></li><li class="next"><a href="/archives/20210328/hello/" title="Hello world">Next Post &rarr;</a></li></ul></div><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1 sidebar-container"><section><h5><a href="/tags/">FEATURED TAGS</a></h5><div class="tags" style="margin-top:-5px"><a class="tag" href="/tags/#逆向" title="逆向">逆向</a> <a class="tag" href="/tags/#CTF" title="CTF">CTF</a></div></section><hr><h5>FRIENDS</h5><ul class="list-inline"><li><a href="https://cjovi.icu/" target="_blank" rel="noopener">cj的小站</a></li><li><a href="https://blog.m1dsummer.top/" target="_blank" rel="noopener">Summer&#39;s personal blog</a></li><li><a href="https://0wl-alt.github.io/" target="_blank" rel="noopener">0wl&#39;s Blog</a></li><li><a href="https://wr-web.github.io/" target="_blank" rel="noopener">云游君的小站</a></li></ul></div></div></div></article></div><footer style="padding-bottom:35px"><div class="container"><div class="row"><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center"><li><a target="_blank" rel="noopener" href="https://twitter.com/gyj1109"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-twitter fa-stack-1x fa-inverse"></i></span></a></li><li><a target="_blank" rel="noopener" href="https://www.zhihu.com/people/gyj1109"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-stack-1x fa-inverse">知</i></span></a></li><li><a target="_blank" rel="noopener" href="https://github.com/gyj1109"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-github fa-stack-1x fa-inverse"></i></span></a></li></ul><p class="copyright text-muted"><a rel="license noopener" target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh"><img alt="知识共享许可协议" style="border-width:0" src="https://cdn.jsdelivr.net/gh/gyj1109/Blog-Resources@latest/img/cc.png"></a><br>本站采用<a rel="license noopener" title="Creative Commons Attribution-ShareAlike 4.0 International License" target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh">知识共享署名-相同方式共享 4.0 国际许可协议</a>进行许可<br>Copyright &copy; 2021 - <a href="/" target="_blank" rel="noopener">Gyj1109</a><br>Theme by <a target="_blank" rel="noopener" href="https://huangxuan.me">Hux</a> • Hosted by <a target="_blank" rel="noopener" href="https://pages.github.com/">GitHub Pages</a></p></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script><script>function async(e,n){var t=document,a="script",r=t.createElement(a),c=t.getElementsByTagName(a)[0];r.src=e,n&&r.addEventListener("load",(function(e){n(null,e)}),!1),c.parentNode.insertBefore(r,c)}</script><script src="https://cdn.jsdelivr.net/npm/jquery-pjax@2.0.1/jquery.pjax.min.js"></script><script>$(document).pjax("a","#pjax",{fragment:"#pjax",timeout:15e3}),$(document).on("pjax:start",(function(){navOpen&&handleMagic(),clearInterval(window.timer),NProgress.configure({minimum:.08,showSpinner:!1,trickle:!0,trickleSpeed:175}),NProgress.start()})),$(document).on("pjax:end",(function(){0!==$("#tag_cloud").length&&($.fn.tagcloud.defaults={color:{start:"#80CBC4",end:"#00695C"}},$("#tag_cloud a").tagcloud());var e,a,s,o,i,t,n=document.querySelector("nav");n&&FastClick.attach(n),e=".catalog-body",$("div.post-container").find("h1,h2,h3,h4,h5,h6").each((function(){a=$(this).prop("tagName").toLowerCase(),i="#"+$(this).prop("id"),s=$(this).text(),t=$('<a href="'+i+'" rel="nofollow">'+s+"</a>"),o=$('<li class="'+a+'_nav"></li>').append(t),$(e).append(o)})),$(".catalog-toggle").click((function(e){e.preventDefault(),$(".side-catalog").toggleClass("fold")})),$(".catalog-body").onePageNav({currentClass:"active",changeHash:!1,easing:"swing",filter:"",scrollSpeed:700,scrollOffset:0,scrollThreshold:.2,begin:null,end:null,scrollChange:null,padding:80}),$("table").wrap("<div class='table-responsive'></div>"),$("table").addClass("table"),$('iframe[src*="youtube.com"]').wrap('<div class="embed-responsive embed-responsive-16by9"></div>'),$('iframe[src*="youtube.com"]').addClass("embed-responsive-item"),$('iframe[src*="vimeo.com"]').wrap('<div class="embed-responsive embed-responsive-16by9"></div>'),$('iframe[src*="vimeo.com"]').addClass("embed-responsive-item");if($(window).width()>1170){var l=$(".navbar-custom").height(),r=$(".intro-header .container").height();$(window).on("scroll",{previousTop:0},(function(){var e=$(window).scrollTop(),a=$(".side-catalog");e<this.previousTop?e>0&&$(".navbar-custom").hasClass("is-fixed")?$(".navbar-custom").addClass("is-visible"):$(".navbar-custom").removeClass("is-visible is-fixed"):($(".navbar-custom").removeClass("is-visible"),e>l&&!$(".navbar-custom").hasClass("is-fixed")&&$(".navbar-custom").addClass("is-fixed")),this.previousTop=e,a.show(),e>r+41?a.addClass("fixed"):a.removeClass("fixed")}))}NProgress.done(),$(".navbar-custom").hasClass("is-fixed")&&$(".navbar-custom").removeClass("is-visible is-fixed"),$("div.zoom").each((function(){new RTP.PinchZoom($(this),{})}));!function(e,a,s,o,i,t,n){e.GoogleAnalyticsObject=i,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,t=a.createElement(s),n=a.getElementsByTagName(s)[0],t.async=1,t.src="//www.google-analytics.com/analytics.js",n.parentNode.insertBefore(t,n)}(window,document,"script",0,"ga"),ga("create","UA-91573622-1","gyj1109.top"),ga("send","pageview")}))</script><script>$("div.zoom").each((function(){new RTP.PinchZoom($(this),{})}))</script><script>0!==$("#tag_cloud").length&&async("https://cdn.jsdelivr.net/gh/gyj1109/Blog/themes/huxblog/source/js/jquery.tagcloud.js",(function(){$.fn.tagcloud.defaults={color:{start:"#80CBC4",end:"#00695C"}},$("#tag_cloud a").tagcloud()}))</script><script>async("https://cdn.jsdelivr.net/npm/fastclick@1.0.6/lib/fastclick.min.js",(function(){var c=document.querySelector("nav");c&&FastClick.attach(c)}))</script><script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-91573622-1","auto"),ga("send","pageview")</script><script async src="https://www.google-analytics.com/analytics.js"></script><script>async("https://cdn.jsdelivr.net/npm/trianglify@2.0.0/dist/trianglify.min.js",(function(){if(targetItem=document.getElementsByTagName("header")[0],"404-intro-header"!=targetItem.id){var t=Trianglify({width:1.2*document.body.clientWidth,height:.9*document.body.clientWidth,cell_size:Math.round(40*Math.random())+40,x_colors:"random"});targetItem.style["background-image"]="url("+t.png()+")",async("https://cdn.jsdelivr.net/npm/colorthief@2.3.0/dist/color-thief.min.js",(function(){var e=(new ColorThief).getColor(t.canvas()),n="#"+((1<<24)+(e[0]<<16)+(e[1]<<8)+e[2]).toString(16).slice(1);document.querySelector("meta[name=theme-color]").setAttribute("content",n)}))}}))</script><script async src="https://cdn.jsdelivr.net/gh/gyj1109/Blog-Resources@latest/js/hux-blog.min.js"></script><script async src="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/js/bootstrap.min.js"></script><script async src="https://cdn.jsdelivr.net/gh/gyj1109/Blog-Resources@latest/js/jquery.tagcloud.min.js"></script><script async src="https://cdn.jsdelivr.net/gh/davist11/jQuery-One-Page-Nav@3.0.0/jquery.nav.min.js"></script><script async src="https://cdn.jsdelivr.net/npm/pinch-zoom-js@2.3.4/dist/pinch-zoom.umd.min.js"></script><script async src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js"></script></body></html>